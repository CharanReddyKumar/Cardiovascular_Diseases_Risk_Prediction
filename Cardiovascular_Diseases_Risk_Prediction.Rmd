---
title: "Cardiovascular_Diseases_Risk_Prediction"
output: html_document
date: "2023-10-06"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Data variables info

General_Health
Would you say that in general your health isâ€”

Checkup
About how long has it been since you last visited a doctor for a routine checkup?

Exercise
During the past month, other than your regular job, did you participate in any physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise?

Heart_Disease
Respondents that reported having coronary heart disease or mycardialinfarction

Skin_Cancer
Respondents that reported having skin cancer

Other_Cancer
Respondents that reported having any other types of cancer

Depression
Respondents that reported having a depressive disorder (including depression, major depression, dysthymia, or minor depression)

Diabetes
Respondents that reported having a diabetes. If yes, what type of diabetes it is/was.

Arthritis
Respondents that reported having an Arthritis

Sex
Respondent's Gender

Age_Category
Height_(cm)
Weight_(kg)
BMI
Smoking_History
Alcohol_Consumption
Fruit_Consumption
Green_Vegetables_Consumption
FriedPotato_Consumption


# Import Library

```{R}
library(dplyr)
library(ggplot2)
library(tidyr)
```

# Import Data

```{R}
df = read.csv('CVD.csv')
```

# Data Summary

```{R}
summary(df)
```
# Missing values
```{R}
# Check for missing values
missing_values <- colSums(is.na(df))
print(missing_values)

```
# Data type correction
```{R}
# Struture of the data.
str(df)


#  'Sex' to a factor
df$Sex <- factor(df$Sex)

#  'Age_Category' to a factor
df$Age_Category <- factor(df$Age_Category)

#  'Smoking_History' to a factor
df$Smoking_History <- factor(df$Smoking_History)

#  'Heart_Disease' to a factor
df$Heart_Disease <- factor(df$Heart_Disease)

#  'Skin_Cancer' to a factor
df$Skin_Cancer <- factor(df$Skin_Cancer)

#  'Other_Cancer' to a factor
df$Other_Cancer <- factor(df$Other_Cancer)

#  'Arthritis' to a factor
df$Arthritis <- factor(df$Arthritis)

#  'Depression' to a factor
df$Depression <- factor(df$Depression)

#  'Diabetes' to a factor
df$Diabetes <- factor(df$Diabetes)

#  'Diabetes' to a factor
df$Exercise <- factor(df$Exercise)

# Structure of the data after factorizing the variables
str(df)

```

# Frequency count 

```{R}
# Frequency count 
categorical_variables <- c("Heart_Disease", "Skin_Cancer", "Other_Cancer","Arthritis", "Sex", "Age_Category" )
for (var in categorical_variables) {
  cat_counts <- table(df[[var]])
  print(cat_counts)
}

```
# Distribution of numeric variables
```{R}
# Visualization of data distribution
numeric_variables <- c("Height_.cm.", "Weight_.kg.", "BMI", "Fruit_Consumption", "Green_Vegetables_Consumption", "FriedPotato_Consumption","Alcohol_Consumption")
for (var in numeric_variables) {
  p <- ggplot(df, aes(x = .data[[var]])) +
    geom_histogram() +
    labs(title = paste("Distribution of", var))
  print(p)
}
```

```{R}
# distribution of health-related issues
health_issues <- c("Heart_Disease", "Skin_Cancer", "Other_Cancer", "Arthritis")
for (issue in health_issues) {
  issue_counts <- table(df[[issue]])
  print(issue_counts)
  # bar chart for each health issue
 p <- ggplot(df, aes(x = .data[[issue]])) +
    geom_bar() +
    labs(title = paste("Distribution of", issue))
  print(p)
}

```
# Health issue - Smoking history
```{R}

# Viz Health issues and Smoking History
health_issues <- c("Heart_Disease", "Skin_Cancer", "Other_Cancer", "Arthritis")
for (issue in health_issues) {

  p = ggplot(df, aes(x = issue , fill = Smoking_History)) +
  geom_bar(position = "fill") 
    
  print(p)

}


```
# Age_Category vs. Heart_Disease
```{R}
ggplot(df, aes(x = Age_Category, fill = Heart_Disease)) +
  geom_bar(position = "fill") +
  labs(title = "Age_Category vs. Heart_Disease")

```
# Other_Cancer vs. Heart_Disease
```{R}
ggplot(df, aes(x = Other_Cancer, fill = Heart_Disease)) +
  geom_bar(position = "fill") +
  labs(title = "Other_Cancer vs. Heart_Disease")
```
# Sex vs. Heart_Disease
```{R}
ggplot(df, aes(x = Sex, fill = Heart_Disease)) +
  geom_bar(position = "fill") +
  labs(title = "Sex vs. Heart_Disease")
```
# Skin_Cancer vs. Heart_Disease
```{R}
ggplot(df, aes(x = Skin_Cancer, fill = Heart_Disease)) +
  geom_bar(position = "fill") +
  labs(title = "Skin_Cancer vs. Heart_Disease")
```
# Alcohol Consumption vs. Heart Disease

```{R}
ggplot(df, aes(x = (Heart_Disease), y = Alcohol_Consumption, fill = Heart_Disease)) +
  geom_boxplot() +
  labs(title = "Alcohol Consumption vs. Heart Disease") +
  ylab("Alcohol Consumption")
```
# BMI vs. Heart Disease
```{R}
ggplot(df, aes(x = Heart_Disease, y = BMI, fill = Heart_Disease)) +
  geom_boxplot() +
  labs(title = "BMI vs. Heart Disease") +
  ylab("BMI")
```
# Fried Potato Consumption vs. Heart Disease
```{R}
ggplot(df, aes(x = Heart_Disease, y = FriedPotato_Consumption, fill = Heart_Disease)) +
  geom_boxplot() +
  labs(title = "Fried Potato Consumption vs. Heart Disease") +
  ylab("Fried Potato Consumption")
```
# Fruit Consumption vs. Heart Disease
```{R}
ggplot(df, aes(x = factor(Heart_Disease), y = Fruit_Consumption, fill = Heart_Disease)) +
  geom_boxplot() +
  labs(title = "Fruit Consumption vs. Heart Disease") +
  ylab("Fruit Consumption")
```

# BMI - Heart Disease
```{r}
ggplot(df, aes(x = BMI, fill = Heart_Disease)) +
  geom_density(alpha = 0.5) +
  labs(title = "BMI Density by Heart_Disease", x = "BMI") +
  scale_fill_manual(values = c("No" = "blue", "Yes" = "red"))


ggplot(df, aes(x = Heart_Disease, y = BMI, fill = Heart_Disease)) +
  geom_violin() +
  labs(title = "BMI vs. Heart_Disease", x = "Heart_Disease", y = "BMI")

# Histograms of BMI by Heart_Disease
ggplot(df, aes(x = BMI, fill = Heart_Disease)) +
  geom_histogram() +
  labs(title = "Histograms of BMI by Heart_Disease", x = "BMI", y = "Frequency") +
  scale_fill_manual(values = c("No" = "blue", "Yes" = "red"))

```
# Heart_Disease vs. Smoking_History (Faceted)
```{R}
# Faceted bar plot of Heart_Disease vs. Smoking_History and Sex
ggplot(df, aes(x = Smoking_History, fill = Heart_Disease)) +
  geom_bar(position = "fill") +
  facet_grid(Sex ~ .) +
  labs(title = "Heart_Disease vs. Smoking_History (Faceted)", x = "Smoking_History", y = "Proportion") +
  scale_fill_manual(values = c("No" = "blue", "Yes" = "red"))

```
```{R}
# Explore Relationships (e.g., Heart_Disease vs. Lifestyle Factors)
health_issues <- c("Heart_Disease", "Skin_Cancer", "Other_Cancer", "Arthritis")
Life_Styles <- c("Exercise", "Sex", "Age_Category", "Height_.cm.", "Weight_.kg.", "BMI", "Smoking_History", "Alcohol_Consumption", "Fruit_Consumption", "Green_Vegetables_Consumption", "FriedPotato_Consumption")

for (issue in health_issues) {
  for (style in Life_Styles){
    p <- ggplot(df, aes(x = .data[[issue]], fill = .data[[style]])) +
      geom_bar(position = "fill") +
      labs(title = paste(issue, "vs.", style))
    print(p)
  }
}
```
```{R}
# Box Plots for numeric variables vs. Heart_Disease
boxplot_data <- df %>%
  select(Heart_Disease, Height_.cm., Weight_.kg., BMI, Fruit_Consumption, Green_Vegetables_Consumption, FriedPotato_Consumption, Alcohol_Consumption)

boxplot_data_long <- boxplot_data %>%
  pivot_longer(cols = -Heart_Disease, names_to = "Variable", values_to = "Value")

p <- ggplot(boxplot_data_long, aes(x = Heart_Disease, y = Value, fill = Heart_Disease)) +
  geom_boxplot() +
  facet_wrap(~Variable, scales = "free_y") +
  labs(title = "Numeric Variables vs. Heart_Disease")

print(p)

```
# chi-squared test between Heart_Disease and Smoking_History
```{R}


# List of categorical variables to be check for relation with Heart_Disease
categorical_variables <- c("Skin_Cancer", "Other_Cancer", "Depression", "Diabetes", "Arthritis", "Sex", "Age_Category", "Exercise", "Smoking_History","Smoking_History")

# chi-squared test for each categorical variable
for (var in categorical_variables) {
  chi_square_result <- chisq.test(df$Heart_Disease, df[[var]])
  cat("\nChi-squared Test: ", var, "vs. Heart_Disease:\n")
  print(chi_square_result)
}


### My Notes: If p value < 0.5 it indicates that both variables are significantly related
### All values are less than 0 and shows that all are significantly related (Should check the code r is it completly fine)
```